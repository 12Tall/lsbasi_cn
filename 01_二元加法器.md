# äºŒå…ƒåŠ æ³•å™¨

> **â€œå¦‚æœä¸çŸ¥é“ç¼–è¯‘å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œé‚£ä½ å°±ä¸çŸ¥é“ç”µè„‘æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼›å¦‚æœä¸èƒ½ç™¾åˆ†ä¹‹ç™¾åœ°ç¡®å®šè‡ªå·±äº†è§£ç¼–è¯‘å™¨çš„å·¥ä½œåŸç†ï¼Œé‚£å°±ç›¸å½“äºä¸€æ— æ‰€çŸ¥â€**  â€”â€” Steve Yegge  

æ­£æ˜¯å¦‚æ­¤ï¼Œæƒ³è±¡ä¸€ä¸‹ã€‚ä¸ç®¡æ˜¯åˆå‡ºèŒ…åºæ–°æ‰‹è¿˜æ˜¯ä¹…ç»æ²™åœºçš„è€é¸Ÿï¼šå¦‚æœä½ ä¸çŸ¥é“`ç¼–è¯‘å™¨`å’Œ`è§£é‡Šå™¨`çš„å·¥ä½œåŸç†ï¼Œé‚£å°±ç›¸å½“äºä½ ä¸çŸ¥é“è®¡ç®—æœºåˆ°åº•å¦‚ä½•å·¥ä½œçš„ã€‚å°±è¿™ä¹ˆç®€å•ã€‚  

æ‰€ä»¥ï¼Œä½ çŸ¥é“ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨çš„å·¥ä½œåŸç†å—ï¼Ÿæˆ‘æ˜¯æŒ‡ï¼š**ä½ ç¡®å®šä½ å®Œå…¨æ¸…æ¥šå®ƒä»¬çš„å·¥ä½œåŸç†å—ï¼Ÿ** å¦‚æœä½ ä¸ç¡®å®š...
![lsbasi_part1_i_dont_know.png](img/01/lsbasi_part1_i_dont_know.png)  

äº¦æˆ–è€…å¯¹æ­¤æ„Ÿåˆ°æœ‰äº›ç„¦è™‘çš„è¯...  
![lsbasi_part1_omg.png](img/01/lsbasi_part1_omg.png)  

åˆ«æ‹…å¿ƒï¼Œå¦‚æœä½ èƒ½åšæŒå’Œæˆ‘ä¸€èµ·å­¦ä¹ å®Œè¿™ä¸ªç³»åˆ—ï¼Œå¹¶åšå‡ºä¸€ä¸ªç¼–è¯‘å™¨å’Œè§£é‡Šå™¨çš„è¯ã€‚ä½ å°±ä¼šæ˜ç™½ä»–ä»¬çš„å·¥ä½œåŸç†äº†ï¼Œå˜å¾—èƒ¸æœ‰æˆç«¹ã€‚è‡³å°‘æˆ‘å¸Œæœ›å¦‚æ­¤:)  
![lsbasi_part1_i_know](img/01/lsbasi_part1_i_know.png)  

**ä¸ºä»€ä¹ˆ(why)** è¦å­¦ä¹ ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ï¼ŒåŸå› æœ‰ä¸‰ï¼š  

1. å®Œæˆä¸€ä¸ªç¼–è¯‘å™¨æˆ–è§£é‡Šå™¨ï¼Œéœ€è¦ç»¼åˆè¿ç”¨å¤§é‡çš„æŠ€æœ¯çŸ¥è¯†ã€‚å®ƒä¼šå¸®åŠ©ä½ æˆä¸ºä¸€ä¸ªæ›´ä¼˜ç§€çš„å¼€å‘è€…ã€‚è€Œä¸”è¿™äº›æŠ€æœ¯åœ¨å¼€å‘ä»»ä½•å…¶ä»–è½¯ä»¶æ—¶ä¹Ÿä¼šéå¸¸æœ‰ç”¨ã€‚  
2. å¦‚æœä½ çœŸçš„æ¸´æœ›ç†è§£è®¡ç®—æœºçš„å·¥ä½œåŸç†ã€‚ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨é€šå¸¸çœ‹èµ·æ¥éå¸¸ç¥å¥‡ï¼Œä½†æ˜¯å­¦ä¹ èµ·æ¥å´æ— ä»ä¸‹æ‰‹ã€‚é€šè¿‡æ„å»ºç¼–è¯‘å™¨å’Œè§£é‡Šå™¨çš„è¿‡ç¨‹ï¼Œæ›´å¥½çš„æŒæ¡å…¶å·¥ä½œåŸç†ã€‚  
3. ä½ æƒ³åˆ›é€ è‡ªå·±çš„ï¼Œæˆ–è€…æ˜¯ç‰¹å®šé¢†åŸŸçš„ç¼–ç¨‹è¯­è¨€ã€‚åœ¨å‘æ˜äº†ä¸€ç§è¯­è¨€åï¼Œè‡ªç„¶è¦æœ‰ä¸ä¹‹é…å¥—çš„ç¼–è¯‘å™¨æˆ–è§£é‡Šå™¨ã€‚è¿‘äº›å¹´æ¥ï¼Œäººä»¬å¯¹æ–°è¯­è¨€ï¼ˆå¼€å‘ï¼‰åˆé‡æ–°ç‡ƒå…´è¶£ï¼Œå‡ ä¹æ¯å¤©éƒ½ä¼šæœ‰æ–°è¯­è¨€çš„äº§ç”Ÿï¼š`Elixir`ã€`Go`ã€`Rust` ç­‰ç­‰  

è¨€å½’æ­£ä¼ ï¼Œç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ç©¶ç«Ÿ **æ˜¯ä»€ä¹ˆ(what)** å‘¢ï¼Ÿ  

ç¼–è¯‘å™¨æˆ–è§£é‡Šå™¨çš„ç›®çš„æ˜¯å°†ä¸€ç§é«˜çº§è¯­è¨€çš„ç¨‹åºä»£ç ç¿»è¯‘æˆå¦å¤–çš„ä¸€ç§è¯­è¨€å½¢å¼ã€‚æœ‰ç‚¹ç»•å¯¹å§ï¼Ÿæš‚ä¸”è¿™æ ·ï¼Œåœ¨åé¢çš„éƒ¨åˆ†ï¼Œä½ å°±ä¼šçœ‹åˆ°æºä»£ç ç©¶ç«Ÿè¢«ç¿»è¯‘æˆäº†ä»€ä¹ˆã€‚ 

ç°åœ¨ä½ ä¹Ÿè®¸ä¼šå¥½å¥‡ï¼šç¼–è¯‘å™¨å’Œè§£é‡Šå™¨çš„ **åŒºåˆ«(difference)** æ˜¯ä»€ä¹ˆï¼Ÿåœ¨æœ¬ç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬æå‰çº¦å®šï¼šå°†ç¨‹åºæºç ç¿»è¯‘æˆæœºå™¨ç çš„å«åšç¼–è¯‘å™¨ï¼›è€Œç›´æ¥å¤„ç†å¹¶æ‰§è¡Œæºç çš„å«åšè§£é‡Šå™¨ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![lsbasi_part1_compiler_interpreter](img/01/lsbasi_part1_compiler_interpreter.png)  

åˆ°è¿™é‡Œï¼Œæˆ‘å¸Œæœ›ä½ ç¡®ä¿¡çœŸçš„æƒ³å­¦ä¹ å¹¶åŠ¨æ‰‹æ„å»ºä¸€ä¸ªç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ã€‚ä½ å¯¹è¿™ä¸ªç³»åˆ—çš„æ–‡ç« è¿˜æœ‰å…¶ä»–çš„æœŸå¾…å—ï¼Ÿ  

ä¸€è¨€ä¸ºå®šï¼åœ¨è¿™ä¸ªç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬å°†ä¸º`Pascal`è¯­è¨€çš„ä¸€ä¸ªå­é›†ç¼–å†™ä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ï¼Œæœ€åä½ å°†æ‹¥æœ‰ä¸€ä¸ªä½¿ç”¨çš„`Pascal`è§£é‡Šå™¨å’Œä¸€ä¸ªæºç çº§çš„è°ƒè¯•å™¨ï¼Œå°±åƒ`Python`çš„`pdb`ä¸€æ ·ã€‚  

ä½ ä¹Ÿè®¸æƒ³é—®ï¼Œä¸ºä»€ä¹ˆæ˜¯`Pascal`ï¼Ÿä¸€è€…å®ƒä¸æ˜¯ä¸€é—¨è™šæ„çš„è¯­è¨€ï¼Œè€Œä¸”æ‹¥æœ‰å¾ˆå¤šé‡è¦çš„è¯­è¨€ç»“æ„ã€‚å†è€…ä¸€äº›ç»å…¸çš„è®¡ç®—æœºæ•™æé€šå¸¸ç”¨`Pascal`è¯­è¨€ä½œä¸ºä¾‹å­è®²è§£(è™½ç„¶è¿™ä¸ªç†ç”±æœ‰ç‚¹ç‰µå¼ºï¼Œä½†æ˜¯æˆ‘ç§ä¸‹é‡Œè®¤ä¸ºå°è¯•å­¦ä¹ ä¸€é—¨éä¸»æµè¯­è¨€ï¼Œä¹Ÿè®¸æ˜¯ä¸€æ¬¡ä¸é”™çš„é€‰æ‹©):)  

ä¸‹é¢æ˜¯ä¸€ä¸ª`Pascal`è¯­è¨€`é˜¶ä¹˜(factorial)`å‡½æ•°çš„ä¾‹å­ï¼Œåœ¨åé¢ä½ å¯ä»¥é€šè¿‡æˆ‘ä»¬æ„å»ºçš„è§£é‡Šå™¨æ‰§è¡Œå¹¶è°ƒè¯•å®ƒã€‚  

```pascal
program factorial;

function factorial(n: integer): lonint;
begin
    if n = 0 then
        factorial := 1
    else
        factorial := n * factorial(n-1)
end;

var n: integer;
begin
    for n := 0 to 16 do
        writeln(n, '! = ',factorial(n));
end.
```

æœ¬ç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨`Python`æ¥å®ç°`Pascal`è§£é‡Šå™¨ï¼Œä½†å®é™…ä¸Šä½ å¯ä»¥é€šè¿‡ä»»ä½•æƒ³ç”¨çš„è¯­è¨€ï¼Œå› ä¸ºæ€æƒ³ä¸ä¾èµ–ä»»ä½•ç‰¹å®šçš„è¯­è¨€ã€‚è¨€å½’æ­£ä¼ ã€‚å‡†å¤‡å‡ºå‘å§ï¼

éªéª¥ä¸€è·ƒï¼Œä¸èƒ½åæ­¥ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå†™ä¸€ä¸ªç®—æ•°è¡¨è¾¾å¼çš„è§£é‡Šå™¨(è®¡ç®—å™¨)ã€‚æœ‰ç‚¹å¤±æœ›å¯¹å§ï¼Œæ›´ç»æœ›çš„æ˜¯æˆ‘ä»¬ä»Šå¤©åªä¼šè®©è¿™ä¸ªè®¡ç®—å™¨åšä¸¤ä¸ªä¸ªä½æ•°ä¹‹é—´çš„åŠ æ³•ï¼Œä¾‹å¦‚ï¼š3+5ã€‚ä½†æ˜¯éº»é›€è™½å°äº”è„ä¿±å…¨ï¼Œå¸Œæœ›ä½ èƒ½ä»”ç»†çœ‹ä¸‹æºç ï¼Œä½ å°±ä¼šå‘ç°å³ä½¿æ˜¯ç®€å•çš„äºŒå…ƒåŠ æ³•å™¨ï¼Œä¹Ÿæœªå¿…å°±æ˜¯é‚£ä¹ˆç®€å•ï¼š

```python
# å£°æ˜è¯(Token)ç±»ï¼šç›¸å½“äºJava ä¸­çš„class
# EOF(end-of-file) ï¼šè¡¨ç¤ºå¯¹äºè¯æ³•åˆ†ææ¥è¯´ï¼Œå·²ç»æ²¡æœ‰å‰©ä½™çš„è¾“å…¥ä¿¡æ¯äº†ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶ç»“æŸæ ‡å¿—
# å¦‚æœå­¦ä¹ è¿‡Cè¯­è¨€ï¼Œå¯èƒ½æ›´å¥½ç†è§£ã€‚
# EOF è¢«ç§°ä¹‹ä¸ºè¯ç´ (lexemer)ï¼šç›¸å½“äºToken ç±»çš„å®ä¾‹å¯¹è±¡(instance)

# å®šä¹‰è¯ç´ çš„ç±»å‹ï¼šæ•´å‹æ“ä½œæ•°ï¼ŒåŠ å·ï¼Œè¾“å…¥ç»“æŸç¬¦
INTEGER,PLUS,EOF = 'INTEGER','PLUS','EOF'

class Token(object):
    def __init__(self,type,value):
        # token å¯¹è±¡çš„ç±»å‹ï¼šçœ‹ä¸Šé¢ğŸ‘†
        self.type = type
        # token çš„å€¼ï¼š[0-9]ã€'+'ã€None
        self.value = value

    def __str__(self):
        # å®ä¾‹å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œç±»ä¼¼äºJava ä¸­çš„toString() æ–¹æ³•
        # ä¾‹å¦‚ï¼š
        #   Token(INTEGER,3)
        #   Token(PLUS,'+')
        return 'Token({type},{value})'.format(
            type = self.type,
            value = repr(self.value)
        )

    def __repr__(self):
        return self.__str__()

class Interpreter(onject):
    def __init__(self,text):
        # å®¢æˆ·ç«¯çš„è¾“å…¥å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š"3+5"
        self.text = text
        # self.pos è¡¨ç¤ºè¾“å…¥å­—ç¬¦ä¸²self.text ä¸­å­—ç¬¦çš„ç´¢å¼•
        self.pos = 0
        # å½“å‰çš„token å®ä¾‹
        self.current_token = None

    def error(self):
        raise Exception('è§£æè¾“å…¥æ—¶å‡ºé”™')

    def get_next_token(self):
        # è¯æ³•åˆ†æå™¨ï¼Œä¹Ÿå«æ‰«æå™¨æˆ–åˆ†è¯å™¨
        #
        # æ­¤æ–¹æ³•ä¼šå°†è¾“å…¥çš„å¥å­ä¾æ¬¡åˆ†æˆè‹¥å¹²ä¸ªtoken å®ä¾‹
        # æ¯æ¬¡è°ƒç”¨åˆ†å‡ºä¸€ä¸ªtoken
        text = self.text

        # å¦‚æœself.pos å·²ç»åˆ°è¾¾è¾“å…¥å­—ç¬¦ä¸²çš„å°¾éƒ¨
        # åˆ™è¿”å›ä¸€ä¸ªEOF token
        if self.pos > len(text) -1:
            return Token(EOF,None)

        # ä»å½“å‰ä½ç½®self.pos è·å–ä¸€ä¸ªå­—ç¬¦
        current_char = text[self.pos]

        # å¦‚æœå½“å‰å­—ç¬¦æ˜¯æ•°å­—ã€åŠ å·ã€å…¶ä»–ï¼Œåšç›¸åº”çš„å¤„ç†
        # è·å–åˆæ³•è¾“å…¥åï¼Œå½“å‰å­—ç¬¦çš„ç´¢å¼•åç§»ä¸€ä½
        if current_char.isdigit():
            token = Token(INTEGER,int(current_char))
            self.pos += 1
            return token
        if current_char == '+':
            token = Token(PLUS,current_char)
            self.pos += 1
            return token
        # éæ³•è¾“å…¥ï¼ŒæŠ¥å¼‚å¸¸
        self.error()

    def eat(self,token_type):
        # éªŒè¯å½“å‰token æ˜¯å¦åˆæ³•
        # åˆæ³•çš„è¯è·å–ä¸‹ä¸€ä¸ªtoken
        if self.current_token.type == token_type:
            self.current_token = self.get_next_token()
        else:
            self.error()

    def expr(self):
        """expr -> INTEGER PLUS INTEGER"""
        # è·å–ç¬¬ä¸€ä¸ªtoken ä¸ºå·¦å€¼
        self.current_token = self.get_next_token()
        #éªŒè¯å·¦å€¼
        left = self.current_token
        self.eat(INTEGER)

        # éªŒè¯åŠ å·
        op = self.current_token
        self.eat(PLUS)

        # éªŒè¯å³å€¼
        right = self.current_token
        self.eat(INTEGER)
        # æ­¤æ—¶self.current_token ä¸ºEOF token

        # éªŒè¯é€šè¿‡ï¼Œå¹¶è¿”å›è®¡ç®—ç»“æœ
        result = left.value + right.value
        return result

def main():
    while True:
        try:
            # Python3 ä½¿ç”¨input() ä»£æ›¿raw_input()
            text = raw_input('calc> ')
        except EOFError:
            break
        if not text:
            continue
        interpreter = Interpreter(text)
        result = interpreter.expr()
        print(result)


if __name__ == '__main__':
    main()
```

å°†ä»¥ä¸Šä»£ç ä¿å­˜ä¸º`calc1.py`ï¼Œä¹Ÿå¯ä»¥ä»[GitHub](https://github.com/rspivak/lsbasi/blob/master/part1/calc1.py)ä¸Šç›´æ¥ä¸‹è½½ã€‚åœ¨æ·±å…¥åˆ†æä¹‹å‰ï¼Œå…ˆè¿è¡Œå‡ æ¬¡ï¼Œè§‚å¯Ÿä¸€ä¸‹ç°è±¡ã€‚ä¸‹é¢æ˜¯åœ¨æˆ‘ç¬”è®°æœ¬ä¸Šçš„è¿è¡Œç»“æœ(`Python3`çš„è¯é¡»ç”¨input() ä»£æ›¿raw_input())ï¼š

```shell
$ python calc1.py
calc> 3+4
7
calc> 3+5
8
calc> 3+9
12
calc>
```  

**ç¨‹åºè¶Šç®€å•ï¼Œå¯¹äººçš„è¦æ±‚å°±è¶Šä¸¥æ ¼ã€‚** å¦‚æœä¸æŒ‰ç…§ä»¥ä¸‹è§„åˆ™è¾“å…¥ï¼Œç¨‹åºå°±ä¼šæŠ¥é”™ï¼š  

- ç¨‹åºåªèƒ½è®¡ç®—ä¸€ä½æ•´æ•°  
- ç›®å‰ä»…æ”¯æŒåŠ æ³•è¿ç®—  
- è¾“å…¥å­—ç¬¦ä¸²ä¸­ä¸å…è®¸åŒ…å«ç©ºæ ¼  

ä½†æ˜¯åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šè®©ç¨‹åºå˜å¾—å¤æ‚(å®Œå¤‡)èµ·æ¥ã€‚

å¥½äº†ï¼Œè®©æˆ‘ä»¬åˆ†æä¸‹ç¨‹åºæ˜¯ **å¦‚ä½•(how)** è¿è¡Œï¼Œå¹¶åšåŠ æ³•è¿ç®—çš„ã€‚  

å½“æˆ‘ä»¬è¾“å…¥`3+5`ä¹‹åï¼Œè§£é‡Šå™¨é¦–å…ˆä¼šå°†å…¶ä½œä¸ºå­—ç¬¦ä¸²`"3+5"`ç¼“å­˜èµ·æ¥ã€‚ä¸ºäº†èƒ½æ­£ç¡®ç†è§£è¡¨è¾¾å¼çš„å«ä¹‰ï¼Œè§£é‡Šå™¨ä¼šå°†è¯¥å­—ç¬¦ä¸²åˆ†è§£æˆ3ä¸ª`è¯(token)`ï¼Œæ¯ä¸ªè¯å¯¹è±¡åŒ…å«æœ‰å®ƒçš„ç±»å‹å’Œå€¼ï¼Œä¾‹å¦‚ï¼š`"3"`è¢«è½¬åŒ–æˆ`æ•´å‹(INTEGER)`å¯¹åº”çš„å€¼å°±æ˜¯æ•´æ•°3.  
è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä½œ`è¯æ³•åˆ†æ(lexical analysis)`ã€‚æ‰€ä»¥ï¼Œè§£é‡Šå™¨é¦–å…ˆéœ€è¦è¯»å–è¾“å…¥å­—ç¬¦ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºä¸€ä¸²è¯å¯¹è±¡ã€‚å®ç°è¯æ³•åˆ†æçš„éƒ¨åˆ†è¢«ç§°ä¸º`è¯æ³•åˆ†æå™¨(lexical analyzeræˆ–è€…lexer)`ï¼Œä¹Ÿç§°ä½œ`æ‰«æå™¨(scanner)`æˆ–`åˆ†è¯å™¨(tokenizer)`ã€‚æ®Šé€”åŒå½’ï¼šéƒ½æ˜¯**å°†è¾“å…¥å­—ç¬¦è½¬åŒ–ä¸ºä¸€ä¸²è¯å¯¹è±¡**  
`get_next_token()`å°±æ˜¯è§£é‡Šå™¨çš„è¯æ³•åˆ†æå™¨ã€‚æ¯æ¬¡è°ƒç”¨éƒ½ä¼šä»è¾“å…¥å­—ç¬¦ä¸²ä¸­è·å–ä¸€ä¸ª`è¯(token)`å¹¶è¿”å›ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒå…·ä½“æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚è¯¥æ–¹æ³•çš„è¾“å…¥æ˜¯å‚¨å­˜åœ¨`text`å˜é‡ä¸­çš„è¾“å…¥å­—ç¬¦ä¸²å’Œå­—ç¬¦ä½ç½®`pos`ã€‚åˆå§‹ä½ç½®æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦`'3'`ã€‚è¯¥æ–¹æ³•é¦–å…ˆæ£€æŸ¥`'3'`æ˜¯ä¸æ˜¯æ•´å‹ï¼Œå¦‚æœæ˜¯ï¼Œ`pos`åç§»ä¸€ä½ï¼Œå¹¶è¿”å›ä¸€ä¸ªå€¼ä¸º3çš„æ•´å‹tokenã€‚  
![lsbasi_part1_lexer1](img/01/lsbasi_part1_lexer1.png)  

ç°åœ¨`pos` æŒ‡å‘`'+'`ï¼Œå†æ¬¡è°ƒç”¨æ­¤æ–¹æ³•ï¼Œæ£€æŸ¥`'+'`æ˜¯å¦æ˜¯æ•´æ•°(å¦)ï¼Œæ˜¯å¦ä¸º`'+'`(æ˜¯)ã€‚ï¼Œ`pos`åç§»ä¸€ä½ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŠ å·tokenã€‚  
![lsbasi_part1_lexer2](img/01/lsbasi_part1_lexer2.png)  

éšå`pos` æŒ‡å‘`'5'`ã€‚å¦‚æ³•ç‚®åˆ¶ï¼Œå¹¶è¿”å›ä¸€ä¸ªå€¼ä¸º5çš„æ•´å‹tokenã€‚  

![lsbasi_part1_lexer3](img/01/lsbasi_part1_lexer3.png)  

æ­¤æ—¶ï¼Œ`pos` åˆ°è¾¾å­—ç¬¦ä¸²å°¾ï¼Œæ‰€ä»¥`get_next_token()`è¿”å›EOFã€‚  

![lsbasi_part1_lexer4](img/01/lsbasi_part1_lexer4.png)  

å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç éªŒè¯ä¸€ä¸‹ï¼š  

```python
>>> from calc1 import Interpreter
>>>
>>> interpreter = Interpreter('3+5')
>>> interpreter.get_next_token()
Token(INTEGER, 3)
>>>
>>> interpreter.get_next_token()
Token(PLUS, '+')
>>>
>>> interpreter.get_next_token()
Token(INTEGER, 5)
>>>
>>> interpreter.get_next_token()
Token(EOF, None)
>>>
```  

ç°åœ¨ä½ çš„è§£é‡Šå™¨å¯ä»¥è®¿é—®token æµï¼Œæ ¹æ®token æµï¼Œè§£é‡Šå™¨éœ€è¦åšä»¥ä¸‹å·¥ä½œï¼šè§£é‡Šå™¨éœ€è¦ä»å¹³å¦çš„token æµä¸­å¯»æ‰¾ä¸€å®šçš„è¯­æ³•ç»“æ„ã€‚è§£é‡Šå™¨éœ€è¦`INTEGER -> PLUS -> INTEGER`çš„token åºåˆ—ï¼Œæ‰€ä»¥å®ƒä¼šä»¥ä¸€å®šçš„é¡ºåºå»éªŒè¯è¯æ³•åˆ†æç”Ÿæˆçš„tokenï¼šæ•´æ•°åè·Ÿç€ä¸€ä¸ªåŠ å·ï¼Œåé¢å†è·Ÿç€ä¸€ä¸ªæ•´æ•°ã€‚  
è´Ÿè´£æ­¤åŠŸèƒ½çš„æ–¹æ³•æ˜¯`expr()`ã€‚**æ­¤æ–¹æ³•ä¼šæŒ‰ä¸€å®šé¡ºåºéªŒè¯tokenï¼Œ** ä¾‹å¦‚ï¼š`INTEGER -> PLUS -> INTEGER`ï¼ŒéªŒè¯é€šè¿‡åï¼Œå¯¹token çš„å€¼è¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œç”±æ­¤ï¼Œæ‰ç®—æ˜¯æˆåŠŸçš„è§£é‡Šäº†è¾“å…¥çš„æ•°å­¦è¿ç®—ã€‚  
`expr()`ä¼šè°ƒç”¨å®ä¾‹æ–¹æ³•`eat()`è¿›è¡Œå½“å‰tokençš„æ ¡éªŒï¼Œæ ¡éªŒé€šè¿‡åä¼šå°†`currnt_token`è‡ªåŠ¨æŒ‡å‘åˆ°ä¸‹ä¸€ä¸ªtokenï¼Œå¦åˆ™å°±ä¼šæŠ›å‡ºå¼‚å¸¸`error()`ã€‚å¦‚æœtokençš„é¡ºåºä¸ç¬¦åˆ`INTEGER -> PLUS -> INTEGER`ï¼Œ`expr()`æœ€åä¹Ÿä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸`error()`ã€‚  

é‡æ–°èµ°ä¸€éè¿™ä¸ªæµç¨‹ï¼š  

- è§£é‡Šå™¨è·å–è¾“å…¥å­—ç¬¦ä¸²ï¼š`"3+5"`  
- è§£é‡Šå™¨è°ƒç”¨`expr()`è·å–token åºåˆ—(ç”±get_next_token()å¾—åˆ°)ã€‚éªŒè¯tokené¡ºåºç¬¦åˆ`INTEGER -> PLUS -> INTEGER`ã€‚æ‰§è¡ŒåŠ æ³•è¿ç®—`3+5` ï¼Œå¹¶è¿”å›ç»“æœã€‚  

æ­å–œä½ ã€‚è‡³æ­¤ä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•æ„å»ºä¸€ä¸ªæœ€ç®€å•çš„è§£é‡Šå™¨ï¼  

ç°åœ¨å¯ä»¥åšä¸€äº›ç»ƒä¹ äº†ã€‚  
![lsbasi_exercises](img/01/lsbasi_exercises.png)  

çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œä¸æ˜¯å—ï¼Ÿæ‰€ä»¥æ¥äº²è‡ªåŠ¨æ‰‹å®Œæˆä¸‹é¢çš„ç»ƒä¹ å§ï¼š  

1. ä¿®æ”¹ç¨‹åºï¼Œä½¿ä¹‹èƒ½å¤Ÿå®Œæˆå¤šä½æ•´æ•°çš„åŠ æ³•è¿ç®—(ä¾‹å¦‚ï¼š"12+3")  
2. ç»™ç¨‹åºæ·»åŠ ä¸€ä¸ªå¯ä»¥è·³è¿‡ç©ºæ ¼çš„æ–¹æ³•(ä¾‹å¦‚ï¼š"12 + 3")  
3. ä¿®æ”¹ç¨‹åºï¼Œä½¿ä¹‹å¯ä»¥åŒæ—¶å®Œæˆå‡æ³•æ“ä½œ(ä¾‹å¦‚ï¼š"7 - 5")  

## å°æ£€æµ‹  

1. ä»€ä¹ˆæ˜¯è§£é‡Šå™¨  
2. ä»€ä¹ˆæ˜¯ç¼–è¯‘å™¨  
3. è§£é‡Šå™¨å’Œç¼–è¯‘å™¨çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ  
4. ä»€ä¹ˆæ˜¯è¯(Token)  
5. å°†è¾“å…¥å­—ç¬¦ä¸²åˆ†è§£æˆä¸€ç³»åˆ—token çš„è¿‡ç¨‹å«ä»€ä¹ˆ  
6. è§£é‡Šå™¨åšè¯æ³•åˆ†æçš„éƒ¨åˆ†æ˜¯ä»€ä¹ˆ  
7. è¯æ³•åˆ†æå™¨ä¸€èˆ¬è¿˜è¢«ç§°åšä»€ä¹ˆ  

åœ¨ç»“æŸä¹‹å‰ï¼Œæˆ‘è¡·å¿ƒå¸Œæœ›ä½ è‡´åŠ›äºå­¦ä¹ ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ï¼Œè€Œä¸æ˜¯æ”¾è¿›æ”¶è—å¤¹ã€‚å¦‚æœä½ åªæ˜¯å¤§è‡´æµè§ˆäº†æœ¬æ–‡ï¼Œé‚£è¯·ä½ ä»å¤´å¼€å§‹ï¼›å¦‚æœä½ ä»”ç»†é˜…è¯»äº†æ–‡ç« å´æ²¡æœ‰åšç»ƒä¹ ï¼Œé‚£è¯·ä½ ç°åœ¨å°±åŠ¨æ‰‹è¯•ä¸€è¯•ï¼›å¦‚æœä½ åªå®Œæˆäº†ä¸€éƒ¨ä»½ç»ƒä¹ ï¼Œé‚£è¯·ä½ å°†å‰©ä¸‹çš„éƒ¨åˆ†ä¹Ÿå®Œæˆã€‚ä½ æ‡‚æˆ‘æ„æ€å§ï¼Œä»ä»Šå¤©èµ·ï¼Œç­¾ä¸‹å­¦ä¹ çš„æ‰¿è¯ºä¹¦ï¼  

*æœ¬äººï¼Œ____ï¼Œä½œä¸ºä¸€ä¸ªå¤´è„‘å’Œèº«ä½“å¥å…¨çš„äººï¼Œåœ¨æ­¤æ‰¿è¯ºï¼Œä»ä»Šå¤©èµ·è‡´åŠ›äºå­¦ä¹ è§£é‡Šå™¨å’Œç¼–è¯‘å™¨ï¼Œç›´è‡³å®Œå…¨æŒæ¡å®ƒä»¬çš„å·¥ä½œåŸç†ä¸ºæ­¢ï¼*  
*ç­¾åï¼š*  
*æ—¥æœŸï¼š*  
![lsbasi_part1_commitment_pledge](img/01/lsbasi_part1_commitment_pledge.png)  

ç­¾ä¸Šå¤§åï¼Œæ”¾åœ¨æ¯å¤©éƒ½å¯ä»¥çœ‹åˆ°çš„åœ°æ–¹ï¼Œä»¥ç¡®ä¿ä½ è®°å¾—è‡ªå·±çš„æ‰¿è¯ºï¼ŒåšæŒå±¥è¡Œè‡ªå·±çš„æ‰¿è¯ºï¼š  
> "æ‰¿è¯ºå°±æ˜¯åšä½ æ‰€è¯´çš„äº‹æƒ…ï¼Œå³ä½¿å½“æ—¶çš„æ¿€æƒ…å·²ç»ä¸åœ¨äº†ä¹Ÿè¿˜æ˜¯è¦åš" â€”â€”Darren Hardy  

å¥½äº†ï¼Œä»Šå¤©å°±åˆ°è¿™å„¿äº†ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬å°†ç€æ‰‹æ‰©å±•æˆ‘ä»¬çš„è®¡ç®—å™¨ï¼Œä½¿ä¹‹èƒ½å¤Ÿå¤„ç†æ›´å¤šã€æ›´å¤æ‚çš„æ•°å­¦è¡¨è¾¾å¼ï¼ŒåŠ æ²¹ï¼  

å¦‚æœä½ å·²ç»è¿«ä¸åŠå¾…æƒ³è¦äº†è§£æ›´å¤šï¼Œä¸‹é¢è¿™äº›å‚è€ƒèµ„æ–™å¯èƒ½ä¼šå¤§æœ‰è£¨ç›Šï¼š  

1. [Language Implementation Patterns: Create Your Own Domain-Specific and General Programming Languages (Pragmatic Programmers)](http://www.amazon.com/gp/product/193435645X/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=193435645X&linkCode=as2&tag=russblo0b-20&linkId=MP4DCXDV6DJMEJBL)  
2. [Writing Compilers and Interpreters: A Software Engineering Approach](http://www.amazon.com/gp/product/0470177071/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=0470177071&linkCode=as2&tag=russblo0b-20&linkId=UCLGQTPIYSWYKRRM)  
3. [Modern Compiler Implementation in Java](http://www.amazon.com/gp/product/052182060X/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=052182060X&linkCode=as2&tag=russblo0b-20&linkId=ZSKKZMV7YWR22NMW)  
4. [Modern Compiler Design](http://www.amazon.com/gp/product/1461446988/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1461446988&linkCode=as2&tag=russblo0b-20&linkId=PAXWJP5WCPZ7RKRD)  
5. [Compilers: Principles, Techniques, and Tools (2nd Edition)](http://www.amazon.com/gp/product/0321486811/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=0321486811&linkCode=as2&tag=russblo0b-20&linkId=GOEGDQG4HIHU56FQ)  

-----  
[é˜…è¯»åŸæ–‡](https://ruslanspivak.com/lsbasi-part1/)  
[Java æºç ](src/Calc01.java)  

åŸæœ¬ä»¥ä¸ºå¾ˆå¿«çš„ç¿»è¯‘å·¥ä½œï¼Œå±…ç„¶èŠ±äº†4ä¸ªå°æ—¶æ‰å‹‰å¼ºå®Œæˆï¼Œä»»é‡è€Œé“è¿œå•Šï¼ŒåŠ æ²¹(à¸‡ â€¢_â€¢)à¸‡  

2020-06-08 ç¬¬ä¸€æ¬¡è¿”å·¥
